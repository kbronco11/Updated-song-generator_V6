<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Song Generator V3</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial; background: #667eea; min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { color: white; text-align: center; margin-bottom: 30px; }
        h1 { font-size: 40px; }
        .main { display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-bottom: 30px; }
        .panel { background: white; padding: 20px; border-radius: 10px; }
        .panel h2 { color: #667eea; margin-bottom: 15px; }
        .control { margin-bottom: 15px; }
        .control label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px; }
        .btn { padding: 10px 20px; margin-top: 10px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn:hover { background: #764ba2; }
        .songs { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; max-height: 500px; overflow-y: auto; }
        .song { background: #f0f0f0; padding: 15px; border-radius: 5px; text-align: center; cursor: pointer; }
        .song:hover { background: #e0e0e0; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center; padding: 20px; }
        .modal.show { display: flex; }
        .modal-content { background: white; padding: 30px; border-radius: 10px; max-width: 700px; width: 100%; max-height: 80vh; overflow-y: auto; }
        .close { float: right; font-size: 30px; cursor: pointer; }
        .lyrics { white-space: pre-wrap; font-family: 'Courier New', monospace; font-size: 13px; line-height: 1.8; }
        .empty { text-align: center; color: #999; padding: 40px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽµ Professional Song Generator V3</h1>
        </header>

        <div class="main">
            <div class="panel">
                <h2>Settings</h2>

                <div class="control">
                    <label>Number of Songs:</label>
                    <input type="number" id="numSongs" value="10" min="1" max="50">
                </div>

                <div class="control">
                    <label>Mood (Optional):</label>
                    <select id="mood">
                        <option value="">-- Choose One --</option>
                        <option value="happy">Happy</option>
                        <option value="uplifting">Uplifting</option>
                        <option value="sad">Sad</option>
                        <option value="melancholic">Melancholic</option>
                        <option value="dark">Dark</option>
                        <option value="intense">Intense</option>
                        <option value="romantic">Romantic</option>
                        <option value="love">Love</option>
                        <option value="energetic">Energetic</option>
                        <option value="powerful">Powerful</option>
                        <option value="chill">Chill</option>
                        <option value="relaxed">Relaxed</option>
                        <option value="aggressive">Aggressive</option>
                        <option value="mysterious">Mysterious</option>
                        <option value="empowering">Empowering</option>
                        <option value="heroic">Heroic</option>
                        <option value="nostalgic">Nostalgic</option>
                        <option value="inspirational">Inspirational</option>
                    </select>
                </div>

                <div class="control">
                    <label>Genre (Optional):</label>
                    <select id="genre">
                        <option value="">-- Choose One --</option>
                        <option value="pop">Pop</option>
                        <option value="rock">Rock</option>
                        <option value="country">Country</option>
                        <option value="rnb">R&B</option>
                        <option value="hiphop">Hip-Hop</option>
                        <option value="indie">Indie</option>
                        <option value="electronic">Electronic</option>
                        <option value="jazz">Jazz</option>
                        <option value="metal">Metal</option>
                        <option value="acoustic">Acoustic</option>
                        <option value="funk">Funk</option>
                        <option value="classical">Classical</option>
                        <option value="ambient">Ambient</option>
                        <option value="reggae">Reggae</option>
                    </select>
                </div>

                <div class="control">
                    <label>Lyrical Theme (Optional):</label>
                    <select id="theme">
                        <option value="">-- Choose One --</option>
                        <option value="heartbreak">Heartbreak</option>
                        <option value="victory">Victory</option>
                        <option value="betrayal">Betrayal</option>
                        <option value="redemption">Redemption</option>
                        <option value="secrets">Secrets</option>
                        <option value="freedom">Freedom</option>
                        <option value="revenge">Revenge</option>
                        <option value="hope">Hope</option>
                        <option value="longing">Longing</option>
                        <option value="growth">Growth</option>
                        <option value="love">Love Story</option>
                        <option value="loss">Loss & Letting Go</option>
                        <option value="journey">Journey & Discovery</option>
                        <option value="empowerment">Self Empowerment</option>
                    </select>
                </div>

                <div class="control">
                    <label>Tempo/Energy (Optional):</label>
                    <select id="tempo">
                        <option value="">-- Choose One --</option>
                        <option value="slow">Slow (Ballad)</option>
                        <option value="slowmedium">Slow-Medium (Dreamy)</option>
                        <option value="medium">Medium (Standard)</option>
                        <option value="midtempo">Mid-Tempo (Groovy)</option>
                        <option value="fast">Fast (Upbeat)</option>
                        <option value="veryfast">Very Fast (Intense)</option>
                        <option value="acoustic">Acoustic (Stripped)</option>
                        <option value="electronic">Electronic (Synth)</option>
                        <option value="uptempo">Up-Tempo (Dance)</option>
                        <option value="hyperpop">Hyperpop (Experimental)</option>
                        <option value="random">Random Tempo</option>
                    </select>
                </div>

                <div class="control">
                    <label>Era/Decade (Optional):</label>
                    <select id="era">
                        <option value="">-- Choose One --</option>
                        <option value="50s">1950s</option>
                        <option value="60s">1960s</option>
                        <option value="70s">1970s</option>
                        <option value="80s">1980s</option>
                        <option value="90s">1990s</option>
                        <option value="2000s">2000s</option>
                        <option value="2010s">2010s</option>
                        <option value="2020s">2020s/Modern</option>
                        <option value="retro">Retro/Timeless</option>
                        <option value="vintage">Vintage</option>
                        <option value="futuristic">Futuristic</option>
                    </select>
                </div>

                <div class="control">
                    <label>Custom Sound/Style (Type Here):</label>
                    <input type="text" id="customStyle" placeholder="e.g., 80s rock, 70s funk, 90s grunge">
                </div>

                <div class="control">
                    <label>Song Length:</label>
                    <select id="songLength">
                        <option value="3">3 Minutes</option>
                        <option value="4">4 Minutes</option>
                        <option value="5">5 Minutes</option>
                        <option value="6">6 Minutes</option>
                        <option value="7">7 Minutes</option>
                        <option value="8">8 Minutes</option>
                    </select>
                </div>

                <div class="control">
                    <label>Mode:</label>
                    <select id="mode">
                        <option value="standard">Standard Song</option>
                        <option value="epic">Epic ðŸ”¥</option>
                    </select>
                </div>

                <div class="control">
                    <label>Collaboration (Optional):</label>
                    <select id="collab">
                        <option value="">-- Choose One --</option>
                        <option value="solo">Solo</option>
                        <option value="duet-random">Duet (Random Style)</option>
                        <option value="duet-mf">Duet (Male Lead / Female Support)</option>
                        <option value="duet-fm">Duet (Female Lead / Male Support)</option>
                        <option value="duet-mf-trade">Duet (Male/Female Trading Lines)</option>
                        <option value="duet-fm-trade">Duet (Female/Male Trading Lines)</option>
                    </select>
                </div>

                <div class="control">
                    <label>Backup Vocals (Optional):</label>
                    <select id="backup">
                        <option value="">-- Choose One --</option>
                        <option value="minimal">Minimal Backing</option>
                        <option value="moderate">Moderate Backing</option>
                        <option value="full">Full Choir/Gospel Style</option>
                    </select>
                </div>

                <div class="control">
                    <label>Artist/Band Style (Type Here):</label>
                    <input type="text" id="artistStyle" placeholder="e.g., Nickelback, Pink Floyd, Taylor Swift">
                </div>

                <div class="control">
                    <label>Ban Words:</label>
                    <textarea id="banWords" placeholder="baby,love,heart" style="height: 50px;"></textarea>
                </div>

                <button class="btn" onclick="generate()" style="width: 100%;">Generate!</button>
            </div>

            <div class="panel">
                <h2>Your Songs</h2>
                <div id="songList" class="songs">
                    <div class="empty">Click Generate to create songs</div>
                </div>
            </div>
        </div>

        <div class="panel">
            <h2>Custom Words</h2>
            <div class="control">
                <label>Adjectives:</label>
                <textarea id="adj" style="height: 60px;"></textarea>
            </div>
            <div class="control">
                <label>Nouns:</label>
                <textarea id="nouns" style="height: 60px;"></textarea>
            </div>
            <div class="control">
                <label>Verbs:</label>
                <textarea id="verbs" style="height: 60px;"></textarea>
            </div>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle" style="color: #667eea; margin-bottom: 20px;"></h2>
            <div class="lyrics" id="modalLyrics"></div>
            <button class="btn" onclick="copyLyrics()" style="width: 100%; margin-top: 20px;">Copy Lyrics</button>
        </div>
    </div>

    <script>
        const defaults = {
            adj: ['Broken', 'Golden', 'Silent', 'Electric', 'Faded', 'Burning', 'Endless', 'Midnight', 'Velvet', 'Dancing', 'Lost', 'Rising', 'Haunted', 'Shattered', 'Mystic', 'Vivid', 'Wild', 'Frozen', 'Twisted', 'Sacred'],
            nouns: ['Heart', 'Sky', 'Rain', 'Fire', 'Dreams', 'Wings', 'Light', 'Ocean', 'Storm', 'Echoes', 'Soul', 'Ghost', 'Paradise', 'Horizon', 'Thunder', 'Shadows', 'River', 'Mountain', 'Stars', 'Moon'],
            verbs: ['Running', 'Falling', 'Rising', 'Breaking', 'Flying', 'Fading', 'Calling', 'Waiting', 'Chasing', 'Letting', 'Burning', 'Drowning', 'Dancing', 'Screaming', 'Breathing', 'Fighting']
        };

        // AD-LIBS for natural flow
        const adlibs = ['Yeah', 'Uh-huh', 'Mmm', 'Oh', 'Woo', 'Hey', 'C\'mon', 'Alright', 'Whoa', 'Ah'];
        const shortAdlibs = ['yeah', 'oh', 'mmm', 'ah', 'hey'];
        const questionAdlibs = ['you know?', 'right?', 'can you feel it?', 'don\'t you see?', 'what can I say?', 'you feel me?'];

        // QUIRKY PRODUCTION ELEMENTS
        const quirkySounds = [
            'record scratch', 'phone ringing', 'cowbell accent', 'vinyl crackle', 
            'crowd cheer', 'glass shatter sound effect', 'thunder rumble', 
            'heartbeat pulse', 'clock ticking', 'door slam', 'car engine rev',
            'bird chirping', 'rain sounds', 'wind chimes', 'whistle melody'
        ];

        // 200+ QUALITY PRE-MADE TITLES
        const qualityTitles = [
            'Take Me Home', 'Hold Me Close', 'Let Me Go', 'Stay With Me', 'Break Me Down',
            'Set Me Free', 'One More Night', 'All Over Again', 'Never Let Go', 'Lost Without You',
            'Feel The Fire', 'Without You', 'Time After Time', 'Into The Night', 'Through The Fire',
            'The Last Goodbye', 'The Only Way', 'When I\'m Gone', 'If I Could', 'If You Stay',
            'Fading Away', 'Burning Bridges', 'Chasing Shadows', 'Breaking Free', 'Falling Apart',
            'Rising Up', 'Standing Strong', 'Running Wild', 'Walking Alone', 'Dancing Tonight',
            'Hearts on Fire', 'Dreams Come True', 'Tears Fall Down', 'Stars Align', 'Shadows Dance',
            'Come Back Home', 'Never Say Never', 'Always Forever', 'Here With Me', 'Close To You',
            'Far Away', 'Right Here', 'Over You', 'Under The Stars', 'Beyond The Sky',
            'After Dark', 'Before Dawn', 'At Midnight', 'Till Morning', 'Every Night',
            'All Day Long', 'Just Once More', 'One Last Time', 'First Love', 'True Love',
            'Wild Heart', 'Cold Hands', 'Warm Touch', 'Sweet Dreams', 'Bitter End',
            'High Hopes', 'Low Down', 'Deep Water', 'Shallow Grave', 'Open Road',
            'Closed Door', 'New Beginning', 'Old Flame', 'Young Blood', 'Ancient Soul',
            'Forever Young', 'Never Old', 'Always New', 'Something Real', 'Nothing Left',
            'Everything Changed', 'Anything Goes', 'Somewhere Out There', 'Nowhere To Run', 'Everywhere I Go',
            'Somebody Save Me', 'Nobody Knows', 'Everybody Hurts', 'Anyone Else', 'Someone Like You',
            'Call Me Maybe', 'Tell Me Why', 'Show Me Love', 'Give Me Strength', 'Bring Me Back',
            'Leave Me Alone', 'Make Me Whole', 'Find My Way', 'Lose Myself', 'Keep Me Safe',
            'Save My Soul', 'Heal My Heart', 'Break These Chains', 'Light The Way', 'Dark Times',
            'Bright Future', 'Long Night', 'Short Days', 'Good Times', 'Bad Habits',
            'Better Days', 'Worst Nightmare', 'Best Friend', 'True Colors', 'False Promises',
            'Real Talk', 'Fake Smile', 'Honest Truth', 'Sweet Lies', 'Bitter Truth',
            'Heavy Heart', 'Light Touch', 'Soft Voice', 'Loud Silence', 'Quiet Storm',
            'Gentle Rain', 'Hard Times', 'Easy Love', 'Tough Love', 'Simple Life',
            'Complicated Feelings', 'Mixed Signals', 'Clear Skies', 'Gray Areas', 'Black And White',
            'Red Flags', 'Green Light', 'Blue Monday', 'Golden Hour', 'Silver Lining',
            'Diamond Eyes', 'Crystal Clear', 'Velvet Night', 'Silk Road', 'Iron Will',
            'Stone Cold', 'Paper Thin', 'Glass Heart', 'Steel Resolve', 'Wooden Heart',
            'Plastic Love', 'Golden Age', 'Silver Tongue', 'Bronze Medal', 'Perfect Storm',
            'Beautiful Disaster', 'Gorgeous Mess', 'Pretty Ugly', 'Sweet Sorrow', 'Happy Tears',
            'Sad Smile', 'Angry Love', 'Peaceful War', 'Silent Scream', 'Loud Whisper',
            'Slow Dance', 'Fast Lane', 'Quick Fix', 'Long Game', 'Short Cut',
            'High Road', 'Low Key', 'Middle Ground', 'Far Cry', 'Close Call',
            'Near Miss', 'Direct Hit', 'Wrong Turn', 'Right Path', 'Straight Line',
            'Crooked Smile', 'Bent Truth', 'Twisted Fate', 'Strange Days', 'Familiar Stranger',
            'Known Unknown', 'Secret Garden', 'Hidden Treasure', 'Lost Cause', 'Found Love',
            'Missing You', 'Wanting More', 'Needing Less', 'Having It All', 'Losing Everything',
            'Winning Streak', 'Lucky Break', 'Second Chance', 'Third Wheel', 'Fourth Wall',
            'Fifth Avenue', 'Sixth Sense', 'Seventh Heaven', 'Eighth Wonder', 'Ninth Life',
            'Tenth Round', 'Hundred Miles', 'Thousand Words', 'Million Dreams', 'Billion Stars',
            'Endless Love', 'Timeless Beauty', 'Ageless Wonder', 'Boundless Joy', 'Limitless Sky',
            'Infinite Possibilities', 'Eternal Flame', 'Immortal Soul', 'Mortal Wounds', 'Temporary Fix',
            'Permanent Mark', 'Lasting Impact', 'Fleeting Moment', 'Brief Encounter', 'Long Goodbye',
            'Quick Hello', 'Slow Burn', 'Fast Forward', 'Rewind Time', 'Play It Again',
            'Pause Button', 'Stop Sign', 'Go Time', 'Wait For Me', 'Come Find Me',
            'Stay The Night', 'Leave At Dawn', 'Return To Sender', 'Keep The Change', 'Break Even',
            'Cash Out', 'All In', 'Fold Now', 'Raise The Stakes', 'Call Your Bluff'
        ];

        const templates = {
            verses: {
                heartbreak: [
                    "I've been staring at your picture for way too long\nTrying to remember where it all went wrong\nEvery memory cuts deeper than before\n{title} is what I'm fighting for",
                    "Saw you yesterday with someone new\nGuess you moved on faster than I thought you'd do\nI'm still here picking up the pieces on my own\n{title}, now I'm all alone",
                    "Three AM and I can't sleep again\nYour ghost is lying where you used to be back then\nI reach across the bed but you're not there\n{title} hangs heavy in the air",
                    "Driving past our favorite places in this town\nEvery street corner brings your memory down\nI thought time would heal but it just makes it worse\n{title} feels like a curse",
                    "Found your t-shirt in my drawer today\nStill smells like you even though you went away\nI should throw it out but I just can't let go\n{title} is all I know",
                    "The radio won't stop playing our old song\nI change the station but the damage is already done\nEvery lyric brings me right back to your touch\n{title} hurts too much",
                    "I wrote you a letter that I'll never send\nSaying all the things I should've said back then\nIt's sitting in my drawer collecting dust\nGotta be {title} or bust",
                    "All our friends have chosen sides it seems\nI lost half my life when I lost you and our dreams\nNow I'm drinking alone on a Friday night\n{title}, nothing's right",
                    "Your voicemail's still the one I hear each day\nI saved it just to hear you one more time this way\nI know I'm pathetic but I don't really care\n{title} everywhere",
                    "Six months later and it feels like yesterday\nWhen you packed your bags and said you couldn't stay\nI keep replaying our last goodbye in my mind\n{title}, I'm not fine"
                ],
                love: [
                    "Never thought I'd feel this way again\nThen you walked into my life and everything made sense\nYou're the missing piece I didn't know I needed here\n{title}, crystal clear",
                    "Every morning when I wake up next to you\nI thank the stars above for making dreams come true\nYou're everything I've ever wanted and much more\n{title}, I adore",
                    "The way you smile lights up the darkest room\nChases all my worries away, makes flowers bloom\nI never knew that love could feel this way\n{title} every day",
                    "Dancing in the kitchen to our favorite song\nYou pull me close and suddenly nothing's wrong\nThese simple moments are what I live for now\n{title}, I vow",
                    "We stayed up all night talking till the sun came up\nSharing secrets over coffee in our favorite cup\nI could listen to your voice for hours on end\n{title}, my best friend",
                    "Late night drives with nowhere left to go\nYour hand in mine, the radio down low\nThese are the moments that I'll remember most\n{title}, let's toast",
                    "You know me better than I know myself\nAll my quirks and flaws you love like nothing else\nI'm so grateful that our paths aligned\n{title} defined",
                    "Your eyes tell stories that I want to read\nYour touch is everything I'll ever need\nI'm lost in this feeling and I don't want to be found\n{title}, profound",
                    "When you're away I count the minutes down\nUntil you're back and safe here in this town\nI miss you more than words could ever say\n{title} each day",
                    "We've built a life that's better than I dreamed\nNothing's ever quite as bad as it once seemed\nWith you beside me I can face anything\n{title}, you bring"
                ],
                empowerment: [
                    "I've been knocked down more times than I can count\nBut I keep getting up, I'll surmount\nEvery obstacle that stands here in my way\n{title} today",
                    "They said I'd never make it on my own\nBut look at me now, see how I've grown\nI proved them wrong and I'll do it again\n{title} within",
                    "No more living in somebody else's shadow\nI'm stepping out into the light right now though\nThis is my time, this is my moment here\n{title}, no fear",
                    "I've learned to love the person in the mirror\nAll my scars and flaws are getting clearer\nThey made me who I am, I'm proud to say\n{title} my way",
                    "Done apologizing for who I am inside\nDone trying to fit in or trying to hide\nI'm embracing every part of me today\n{title}, I'll stay",
                    "My voice was silenced but I found it again\nI'm speaking up now, I'm not giving in\nTo anyone who tries to dim my light\n{title}, I'll fight",
                    "They underestimated what I could do\nNow I'm proving that their doubts weren't true\nI'm stronger than they'll ever understand\n{title}, I'll stand",
                    "I've walked through fire and came out alive\nMore than surviving, I'm learning to thrive\nNothing can stop me when I set my mind\n{title}, I'll find",
                    "Every failure taught me something new\nEvery setback made me push right through\nI'm grateful for the struggles that I've faced\n{title}, embraced",
                    "I don't need a hero to come save me here\nI'm my own hero, let me make it clear\nI rescue myself every single day\n{title}, my way"
                ],
                nostalgia: [
                    "Remember summer nights when we were seventeen\nStaying out too late, living the dream\nThose days are gone but memories remain\n{title} again",
                    "Found an old shoebox full of photographs\nMade me smile and made me laugh\nAt all the things we used to do back then\n{title}, my friend",
                    "The old neighborhood doesn't look the same\nThey tore down our hangout, what a shame\nBut I can still see us there if I try\n{title}, goodbye",
                    "Mom's old records playing on the stereo\nRemind me of a time so long ago\nWhen life was simple and the world was new\n{title}, me and you",
                    "The mixtapes that we made each other then\nI found mine and played it once again\nEvery song brought back a memory\n{title}, I see",
                    "Remember staying up till dawn just talking\nThrough the neighborhood just walking\nThose conversations meant the world to me\n{title}, I decree",
                    "The diner where we spent every Friday night\nOrdering fries and everything was right\nWish I could go back one more time\n{title} sublime",
                    "Old home videos from way back when\nWatching them makes me miss it all again\nThe sound of laughter, innocence so pure\n{title} for sure",
                    "The songs we sang on summer car rides\nWindows down with nothing to hide\nThose moments felt like they would never end\n{title}, my friend",
                    "Family dinners around the table each night\nEveryone together, everything was right\nI miss those days more than words can say\n{title} today"
                ],
                freedom: [
                    "Packed my bags and left it all behind\nNo more chains, no more confined\nI'm heading out to find what I've been missing here\n{title}, no fear",
                    "Windows down and music up real loud\nLost in the wind, lost in the crowd\nOf possibilities that stretch ahead so far\n{title}, my star",
                    "No more living by their rules and regulations\nI'm seeking my own destination\nWherever the road takes me I will go\n{title}, I know",
                    "Cut all the strings that held me to the ground\nNow I'm flying, I'm unbound\nTasting freedom for the very first time\n{title}, I climb",
                    "The open road is calling out my name\nI'll never be the same\nAfter I've seen all there is to see\n{title}, decree",
                    "Breaking out of this small town tonight\nChasing stars with all my might\nThe world is bigger than these city limits here\n{title}, I steer",
                    "I was a bird trapped in a cage too small\nNow I'm soaring above it all\nFlying higher than I ever thought I'd go\n{title}, I flow",
                    "The horizon's mine to chase down now\nI'm unshackled somehow\nFrom everything that said I had to stay\n{title}, today",
                    "Living wild and living on my own terms\nI've learned\nThat the only life worth living is one that's free\n{title}, I see",
                    "No more schedules, no more nine to five\nI'm alive\nIn ways I never was when I was trapped\n{title}, unwrapped"
                ]
            },
            
            prechoruses: {
                heartbreak: [
                    "And I know I should let go\nBut my heart won't let me though\nI'm stuck here in between\n{title}, what's it mean",
                    "Every night I lie awake\nWondering what it would take\nTo get you back again\nJust {title}, my friend",
                    "I see you everywhere I go\nI see your face in the crowd\nCan't escape, you should know\nYou're haunting me each day",
                    "Maybe someday I'll be fine\nBut tonight you're still mine\nIn my memories at least\n{title}, released",
                    "I'm trying hard to move along\nBut everything feels wrong\nWithout you by my side\n{title}, I've tried"
                ],
                love: [
                    "And I never want to lose this feeling here\nWith you everything is crystal clear\nYou're my forever and a day\n{title}, I'll say",
                    "Every moment with you feels so right\nLike coming home after a long flight\nYou're my safe place to be\n{title}, I see",
                    "I never knew love could be this way\nEvery night and every day\nYou show me what it means\n{title}, it seems",
                    "This is what I've been waiting for\nYou're everything and so much more\nThan I could ever dream\n{title}, supreme",
                    "You've changed my life in every way\nThere's nothing else I need to say\nExcept I love you more and more\n{title}, I'm sure"
                ],
                empowerment: [
                    "And I'm not backing down this time\nI'm claiming what is mine\nNo one can stop me now\n{title}, I vow",
                    "I've found my voice and I'll use it loud\nI'm standing tall, I'm standing proud\nNothing's holding me back anymore\n{title}, I soar",
                    "They can't define who I'm meant to be\nI'm breaking free, I decree\nMy destiny is mine to make\n{title}, I'll take",
                    "Every scar has made me strong\nI've been right where I belong\nAll along inside of me\n{title}, I'm free",
                    "I'm done living in the past\nI'm moving forward fast\nTo everything I'm meant to be\n{title}, I see"
                ],
                nostalgia: [
                    "If I could turn back time somehow\nI'd be there right now\nReliving every precious day\n{title}, I'd stay",
                    "Those memories keep me warm at night\nWhen everything's not quite right\nI close my eyes and I'm back there\n{title}, I swear",
                    "I wish I knew back then\nThat it would end\nI would have held on tighter to those days\n{title}, always",
                    "Time moves fast and life goes on\nBut those days aren't really gone\nThey live inside of me\n{title}, I see",
                    "I'm grateful for the past we shared\nAll the love and all the care\nThose moments shaped who I am now\n{title}, somehow"
                ],
                freedom: [
                    "And I can feel it in my bones\nI'm finally coming home\nTo who I'm meant to be\n{title}, I'm free",
                    "The chains are broken on the ground\nI'm finally unbound\nFrom everything that held me down\n{title}, I've found",
                    "There's no going back from here\nThe path ahead is clear\nI'm running towards the light\n{title}, in flight",
                    "Liberation's in my veins\nI've broken all the chains\nNothing's stopping me today\n{title}, I'll stay",
                    "The cage door's open wide\nNo reason left to hide\nI'm stepping into my own power now\n{title}, I vow"
                ]
            },

            choruses: {
                heartbreak: [
                    "Gonna give you {title}\nWhy'd you have to walk away\nHmm, yeah\n{title}\nNothing left for me to say\nExcept I miss you every single day",
                    "{title}\nI'm not okay without you here\n{title}\nWishing you would reappear\nIn my life like you used to be\n{title}, can't you see",
                    "Yes, {title}\nWhy'd you have to walk away\nOh, {title}\nAll I can do is pray\nI miss you every single day",
                    "{title}\nEchoing through empty rooms\nYeah, {title}\nMemories like old perfumes\nLingering long after you're gone",
                    "{title}\nIs all I have left of us\nMmm, {title}\nBroken dreams and shattered trust\nI'm picking up the pieces on my own"
                ],
                love: [
                    "{title}\nYou're everything to me\nYeah, {title}\nExactly where I want to be\nRight here in your arms tonight",
                    "{title}\nI'm falling deeper every day\nOh, {title}\nIn every single way\nYou make my world complete",
                    "{title}\nForever's what I want with you\nMmm, {title}\nEvery word you say is true\nYou're my once in a lifetime",
                    "{title}\nLike nothing I've felt before\nYeah, {title}\nYou're all I'm living for\nEvery moment by your side",
                    "{title}\nThe way you make me feel inside\nOh, {title}\nLike I'm finally alive\nThis is what love's supposed to be"
                ],
                empowerment: [
                    "{title}\nI'm taking back my power now\nYeah, {title}\nWatch me rise, I'll show you how\nNothing's gonna bring me down again",
                    "{title}\nI'm stronger than I've ever been\nOh, {title}\nWatch me rise and watch me win\nNo one's standing in my way today",
                    "{title}\nI'm unstoppable right now\nMmm, {title}\nI've learned how\nTo stand up tall and take my place",
                    "{title}\nI'm a force you can't contain\nYeah, {title}\nBreaking every chain\nI'm powerful and I'm free",
                    "{title}\nI'm everything I need to be\nOh, {title}\nWatch me break free\nFrom everything that held me back before"
                ],
                nostalgia: [
                    "{title}\nTake me back to yesterday\nYeah, {title}\nWhen life was simple in every way\nI'd give anything to feel that way again",
                    "{title}\nThose were the days we'll never forget\nOh, {title}\nNo regrets\nJust memories that keep me warm at night",
                    "{title}\nWishing I could turn back time\nMmm, {title}\nWhen everything was fine\nBefore the world got so complicated here",
                    "{title}\nRemembering the way we were\nYeah, {title}\nEverything's a blur\nExcept those precious moments that we shared",
                    "{title}\nTake me back to simpler times\nOh, {title}\nWhen the world was mine\nAnd everything felt possible to do"
                ],
                freedom: [
                    "{title}\nI'm finally breaking free tonight\nYeah, {title}\nSpreading my wings for the first time in flight\nNothing's holding me down anymore",
                    "{title}\nThe open road is calling me\nOh, {title}\nThis is what it means to be\nCompletely free and on my own",
                    "{title}\nLike a bird without a cage\nMmm, {title}\nTurning to a brand new page\nI'm writing my own story from today",
                    "{title}\nNo more chains to hold me here\nYeah, {title}\nThe horizon's crystal clear\nI'm running towards my destiny",
                    "{title}\nI'm answering the call\nOh, {title}\nBreaking down every wall\nThat ever tried to keep me locked inside"
                ]
            },

            bridges: [
                "Maybe this is just the way it goes\nMaybe everybody knows\nThat {title}\nIs worth holding onto tight",
                "I've been thinking about what you said\nAll those words still in my head\nAbout {title}\nAnd what it means to me, yeah",
                "If I could do it all again\nI'd probably do the same back then\nBecause {title}\nTaught me who I am",
                "What if I'm not ready yet\nWhat if I'm full of regret\nAbout {title}\nAnd everything it means, you know?",
                "When the dust finally settles down\nWhen I'm no longer spinning round\n{title}\nWill still be here with me"
            ],

            outros: [
                "{title}...\nForever in my heart...",
                "Oh, {title}...\nYeah, yeah, yeah...",
                "{title}...\n{title}...",
                "Mmm, {title}...\nAlways...",
                "{title}, yeah...\nForever and always...",
                "This is my {title}...\nI miss you every day...",
                "Oh, {title}...\nMmm...",
                "Yeah, {title}...\n{title}..."
            ]
        };

        const intros = {
            pop: ['[Intro - Bright synth melody, punchy drums at 110 bpm]', '[Intro - Catchy keyboard hook, four-on-floor kick]', '[Intro - Shimmering synth pads, crisp hi-hats]'],
            rock: ['[Intro - Heavy distorted guitar riff, aggressive drums at 120 bpm]', '[Intro - Crunchy electric guitar, power chords]', '[Intro - Raw guitar, punchy drum fills]'],
            country: ['[Intro - Clean acoustic fingerpicking, subtle pedal steel at 95 bpm]', '[Intro - Gentle steel guitar, brushed drums]', '[Intro - Twangy electric guitar, steady snare]'],
            rnb: ['[Intro - Smooth electric piano, laid-back drums at 85 bpm]', '[Intro - Silky synth pads, subtle snare]', '[Intro - Rhodes piano, finger snaps]'],
            indie: ['[Intro - Jangly guitar with reverb, minimal drums at 100 bpm]', '[Intro - Clean guitar arpeggios, dreamy pads]', '[Intro - Lo-fi drum pattern, warm synths]'],
            electronic: ['[Intro - Pulsing synth arpeggios at 128 bpm]', '[Intro - Glitchy beats, sweeping filters]', '[Intro - House piano stabs, four-on-floor]'],
            acoustic: ['[Intro - Fingerstyle acoustic, gentle strumming at 90 bpm]', '[Intro - Solo acoustic melody, soft percussion]', '[Intro - Delicate picking, light shaker]'],
            metal: ['[Intro - Brutal downtuned riff, double-kick at 140 bpm]', '[Intro - Fast tremolo picking, blast beats]', '[Intro - Heavy palm-muted chugs]'],
            hiphop: ['[Intro - Hard-hitting 808s, tight hi-hats at 95 bpm]', '[Intro - Sampled melody, boom-bap drums]', '[Intro - Trap hi-hats, deep bass]'],
            jazz: ['[Intro - Smooth saxophone, brushed drums at 110 bpm]', '[Intro - Piano comping, walking bass]', '[Intro - Mellow trumpet, ride cymbal]'],
            funk: ['[Intro - Slap bass groove, chicken scratch guitar at 105 bpm]', '[Intro - Tight drum pocket, wah guitar]', '[Intro - Syncopated bass, horn stabs]'],
            classical: ['[Intro - Orchestral strings, gentle dynamics]', '[Intro - Piano melody, string accompaniment]', '[Intro - Chamber ensemble, refined arrangement]'],
            ambient: ['[Intro - Atmospheric pads, sparse textures]', '[Intro - Reverb-drenched tones, minimal percussion]', '[Intro - Ethereal soundscapes, slow evolution]'],
            reggae: ['[Intro - Offbeat guitar skank, one-drop drums at 85 bpm]', '[Intro - Dub bass, steady riddim]', '[Intro - Organ chords, laid-back groove]']
        };

        const chorusDescriptions = {
            pop: 'Full arrangement - catchy hooks, uplifting energy',
            rock: 'Powerful guitars - driving drums, raw vocals',
            country: 'Pedal steel shines - heartfelt delivery, warm tone',
            rnb: 'Smooth vocals - layered harmonies, groovy bass',
            indie: 'Atmospheric build - reverb-soaked, emotional peak',
            electronic: 'Drop hits - synth explosion, driving beat',
            acoustic: 'Intimate delivery - raw emotion, stripped back',
            metal: 'Crushing riffs - blast beats, aggressive vocals',
            hiphop: 'Hard-hitting - flow intensifies, bass drops',
            jazz: 'Improvisation peak - swinging rhythm, horn section',
            funk: 'Groove locks in - tight pocket, infectious energy',
            classical: 'Orchestral swell - dynamic crescendo, full ensemble',
            ambient: 'Textural peak - layers build, atmospheric climax',
            reggae: 'Riddim intensifies - bass heavy, uplifting skank'
        };

        const duetTypes = [
            {v1:'Male',v2:'Female',c:'Both vocals unite'},
            {v1:'Female',v2:'Male',c:'Harmonized duet'},
            {v1:'Male lead',v2:'Female harmony',c:'Male with female backing'},
            {v1:'Female lead',v2:'Male harmony',c:'Female with male backing'}
        ];

        const backupDesc = {
            minimal: ['subtle backing on key phrases', 'light harmonies background', 'occasional vocal support'],
            moderate: ['layered backing throughout', 'strong harmony supporting', 'backing choir on chorus'],
            full: ['full gospel choir', 'powerful choir with ad-libs', 'massive vocal ensemble']
        };

        let allLyrics = {};

        function r(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

        function getWords(t) {
            const el = document.getElementById(t === 'adj' ? 'adj' : t === 'nouns' ? 'nouns' : 'verbs');
            const val = el.value.trim();
            return val ? val.split(',').map(w => w.trim()) : defaults[t];
        }

        function w(t, b) {
            const words = getWords(t);
            if (!b || b.length === 0) return r(words);
            const filtered = words.filter(w => !b.some(x => w.toLowerCase().includes(x.toLowerCase())));
            return filtered.length > 0 ? r(filtered) : r(words);
        }

        function makeTitle(banned) {
            // 70% chance use quality pre-made title, 30% generate smart random
            if (Math.random() < 0.7) {
                const validTitles = qualityTitles.filter(t => !banned.some(b => t.toLowerCase().includes(b.toLowerCase())));
                if (validTitles.length > 0) {
                    return r(validTitles);
                }
            }

            // Smart random title generation with proper grammar
            const adjs = getWords('adj');
            const nouns = getWords('nouns');
            const vrbs = getWords('verbs');
            
            const actionVerbs = ['Take', 'Hold', 'Let', 'Break', 'Set', 'Feel', 'Chase', 'Find', 'Lose', 'Keep', 'Give', 'Show', 'Tell', 'Bring', 'Leave', 'Make', 'Save', 'Heal', 'Call', 'Come', 'Stay', 'Go', 'Wait', 'Run', 'Walk', 'Stand', 'Fly'];
            const objects = ['Me', 'You', 'Us', 'Home', 'Tonight', 'Forever', 'Again'];
            const prepositions = ['In', 'On', 'Through', 'Without', 'With', 'Under', 'Over', 'Beyond', 'Into', 'Across', 'After', 'Before', 'Beneath', 'Above', 'Around'];

            const pattern = Math.floor(Math.random() * 6);
            let title;
            
            if (pattern === 0) {
                // "Verb Me Adverb" - Hold Me Close, Take Me Home
                const adverbs = ['Close', 'Home', 'Tonight', 'Away', 'Higher', 'Now', 'Forever'];
                title = r(actionVerbs) + ' Me ' + r(adverbs);
            } else if (pattern === 1) {
                // "Adjective Noun" - Broken Dreams, Wild Heart
                title = r(adjs) + ' ' + r(nouns);
            } else if (pattern === 2) {
                // "The Adjective Noun" - The Last Goodbye
                title = 'The ' + r(adjs) + ' ' + r(nouns);
            } else if (pattern === 3) {
                // "Preposition The Noun" - Through The Fire, Under The Stars
                title = r(prepositions) + ' The ' + r(nouns);
            } else if (pattern === 4) {
                // "Verb The Noun" - Break The Chains, Feel The Fire
                title = r(actionVerbs) + ' The ' + r(nouns);
            } else {
                // "Noun And Noun" - Fire And Ice, Love And War
                title = r(nouns) + ' And ' + r(nouns);
            }
            
            if (banned.some(b => title.toLowerCase().includes(b.toLowerCase()))) {
                return makeTitle(banned);
            }
            
            return title;
        }

        function makeLyrics(title, banned) {
            const length = parseInt(document.getElementById('songLength').value);
            const genre = document.getElementById('genre').value || 'pop';
            const themeSetting = document.getElementById('theme').value;
            const collab = document.getElementById('collab').value;
            const backup = document.getElementById('backup').value;

            // Map theme to template category
            const themeMap = {
                'heartbreak': 'heartbreak',
                'betrayal': 'heartbreak',
                'loss': 'heartbreak',
                'longing': 'heartbreak',
                'love': 'love',
                'romantic': 'love',
                'victory': 'empowerment',
                'empowerment': 'empowerment',
                'redemption': 'empowerment',
                'growth': 'empowerment',
                'hope': 'empowerment',
                'nostalgia': 'nostalgia',
                'freedom': 'freedom',
                'journey': 'freedom',
                'revenge': 'empowerment',
                'secrets': 'nostalgia'
            };

            const theme = themeMap[themeSetting] || r(['heartbreak', 'love', 'empowerment', 'nostalgia', 'freedom']);

            // Duet setup
            let duet = null, isDuet = false;
            if (collab && collab.startsWith('duet')) {
                isDuet = true;
                if (collab === 'duet-random') duet = r(duetTypes);
                else if (collab === 'duet-mf') duet = duetTypes[2];
                else if (collab === 'duet-fm') duet = duetTypes[3];
                else if (collab === 'duet-mf-trade') duet = duetTypes[0];
                else if (collab === 'duet-fm-trade') duet = duetTypes[1];
                else duet = duetTypes[0];
            }

            const bk = backup && backupDesc[backup] ? ', ' + r(backupDesc[backup]) : '';
            
            let s = '';
            
            // QUIRKY INTRO (10% chance)
            if (Math.random() < 0.1) {
                s += '[Intro - ' + r(quirkySounds) + ', then ' + r(intros[genre] || intros.pop).replace('[Intro - ', '').replace(']', '') + ']\n\n';
            } else {
                s += r(intros[genre] || intros.pop) + '\n\n';
            }

            // RANDOMIZE STRUCTURE (30% chance to start with chorus instead of verse)
            const startWithChorus = Math.random() < 0.3;

            if (startWithChorus) {
                // START WITH CHORUS
                const chorus = r(templates.choruses[theme]).replace(/{title}/g, title);
                s += '(Chorus)' + (isDuet?' ['+duet.c+']':'') + ' [' + (chorusDescriptions[genre] || chorusDescriptions.pop) + bk + ']\n';
                s += chorus + '\n\n';
            }

            // VERSE 1
            const verse1 = r(templates.verses[theme]).replace(/{title}/g, title);
            s += '(Verse 1)' + (isDuet ? ' ['+duet.v1+' vocal]' : '') + '\n';
            s += verse1 + '\n';
            // Random ad-lib after verse (40% chance)
            if (Math.random() < 0.4) s += r(shortAdlibs) + ', ' + r(questionAdlibs) + '\n';
            s += '\n';

            // PRE-CHORUS 1 (skip 30% of the time for unpredictability)
            if (Math.random() > 0.3) {
                const prechorus1 = r(templates.prechoruses[theme]).replace(/{title}/g, title);
                s += '(Pre-Chorus) [Building' + bk + ']\n';
                s += prechorus1 + '\n\n';
            }

            // CHORUS 1 (if didn't start with it)
            if (!startWithChorus) {
                const chorus = r(templates.choruses[theme]).replace(/{title}/g, title);
                s += '(Chorus)' + (isDuet?' ['+duet.c+']':'') + ' [' + (chorusDescriptions[genre] || chorusDescriptions.pop) + bk + ']\n';
                s += chorus + '\n\n';
            }

            // VERSE 2
            const verse2 = r(templates.verses[theme]).replace(/{title}/g, title);
            s += '(Verse 2)' + (isDuet?' ['+duet.v2+' takes lead]':'') + '\n';
            s += verse2 + '\n';
            if (Math.random() < 0.3) s += r(adlibs) + '\n';
            s += '\n';

            // PRE-CHORUS 2 (skip sometimes)
            if (length >= 4 && Math.random() > 0.2) {
                const prechorus2 = r(templates.prechoruses[theme]).replace(/{title}/g, title);
                s += '(Pre-Chorus) [Energy rising' + bk + ']\n';
                s += prechorus2 + '\n\n';
            }

            // CHORUS 2
            const chorus = r(templates.choruses[theme]).replace(/{title}/g, title);
            s += '(Chorus)' + (isDuet?' ['+duet.c+']':'') + ' [' + (chorusDescriptions[genre] || chorusDescriptions.pop) + ' - fuller' + bk + ']\n';
            s += chorus + '\n\n';

            // For 5+ minute songs add more content
            if (length >= 5) {
                // INSTRUMENTAL BREAK (20% chance before bridge)
                if (Math.random() < 0.2) {
                    s += '[Instrumental Break - ' + genre + ' showcase';
                    if (Math.random() < 0.15) s += ' with ' + r(quirkySounds);
                    s += ']\n\n';
                }

                // BRIDGE
                const bridge = r(templates.bridges).replace(/{title}/g, title);
                s += '[Bridge - Stripped down, building]' + (isDuet?' [Trading lines]':'') + '\n';
                s += bridge + '\n\n';

                // VERSE 3
                const verse3 = r(templates.verses[theme]).replace(/{title}/g, title);
                s += '(Verse 3)' + (isDuet?' [Both harmonized]':'') + '\n';
                s += verse3 + '\n';
                if (Math.random() < 0.4) s += r(adlibs) + ', ' + r(questionAdlibs) + '\n';
                s += '\n';
                
                // Additional pre-chorus
                const prechorus3 = r(templates.prechoruses[theme]).replace(/{title}/g, title);
                s += '(Pre-Chorus) [Final build' + bk + ']\n';
                s += prechorus3 + '\n\n';
            }

            // For 6+ minute songs
            if (length >= 6) {
                s += '[Instrumental Break - ' + genre + ' showcase]\n\n';
                
                // Extra chorus
                s += '(Chorus)' + (isDuet?' ['+duet.c+']':'') + ' [' + (chorusDescriptions[genre] || chorusDescriptions.pop) + bk + ']\n';
                s += chorus + '\n\n';
            }

            // For 7+ minute songs
            if (length >= 7) {
                const verse4 = r(templates.verses[theme]).replace(/{title}/g, title);
                s += '(Verse 4)' + (isDuet?' [Harmonized throughout]':'') + '\n';
                s += verse4 + '\n';
                if (Math.random() < 0.5) s += r(adlibs) + '\n';
                s += '\n';
                
                const prechorus4 = r(templates.prechoruses[theme]).replace(/{title}/g, title);
                s += '(Pre-Chorus) [Epic build' + bk + ']\n';
                s += prechorus4 + '\n\n';
            }

            // For 8 minute songs
            if (length >= 8) {
                s += '[Extended Instrumental - ' + genre + ' solo section';
                if (Math.random() < 0.2) s += ' with ' + r(quirkySounds);
                s += ']\n\n';
                
                s += '(Chorus)' + (isDuet?' ['+duet.c+']':'') + ' [' + (chorusDescriptions[genre] || chorusDescriptions.pop) + ' - massive' + bk + ']\n';
                s += chorus + '\n\n';
            }

            // FINAL CHORUS
            s += '(Final Chorus)' + (isDuet?' [Both full power]':'') + ' [' + (chorusDescriptions[genre] || chorusDescriptions.pop) + ' - climactic' + (backup==='full'?', choir maximum':bk) + ']\n';
            s += chorus + '\n\n';

            // Extended outro for long songs
            if (length >= 7) {
                s += '(Outro Chorus) [Extended' + (backup==='full'?' - choir climax':'') + ']\n';
                s += chorus + '\n\n';
            }

            // OUTRO
            const outro = r(templates.outros).replace(/{title}/g, title);
            s += '[Outro - Fade';
            if (Math.random() < 0.15) s += ' with ' + r(quirkySounds);
            s += ' after 10 seconds]\n';
            s += outro + '\n';

            return s;
        }

        function generate() {
            const num = parseInt(document.getElementById('numSongs').value);
            const banText = document.getElementById('banWords').value;
            const banned = banText.split(',').map(w => w.trim()).filter(w => w);

            const list = document.getElementById('songList');
            list.innerHTML = '';
            allLyrics = {};

            for (let i = 0; i < num; i++) {
                try {
                    const title = makeTitle(banned);
                    const lyrics = makeLyrics(title, banned);
                    allLyrics[title] = lyrics;

                    const div = document.createElement('div');
                    div.className = 'song';
                    div.textContent = title;
                    div.onclick = () => showModal(title);
                    list.appendChild(div);
                } catch (error) {
                    console.error('Error generating song:', error);
                    alert('Error generating song: ' + error.message);
                    break;
                }
            }
        }

        function showModal(title) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalLyrics').textContent = allLyrics[title];
            document.getElementById('modal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('show');
        }

        function copyLyrics() {
            navigator.clipboard.writeText(document.getElementById('modalLyrics').textContent);
            alert('Copied!');
        }

        window.onload = () => {
            document.getElementById('adj').value = defaults.adj.join(', ');
            document.getElementById('nouns').value = defaults.nouns.join(', ');
            document.getElementById('verbs').value = defaults.verbs.join(', ');
        };
    </script>
</body>
</html>
